---
import type { PageAstroInstance } from "helpers/types";

import { LeftNavigation } from "components";

import { IconFilters, iconCategories } from "pageletes/icons";

const { url } = Astro.request;

const { pathname } = Astro.url;

const isComponentPage = url.includes("components");

let componentPages: PageAstroInstance[] = [];

const pages = (await Astro.glob<PageAstroInstance>("../**/*.astro"))
  .filter((page) => page.title)
  .map((page) => ({
    ...page,
    title: page.title,
    keywords: page.keywords,
  }));

if (isComponentPage)
  componentPages = pages.filter((page) => page.url?.includes("components"));
---

{
  pathname.includes("icons") ? (
    <IconFilters categories={iconCategories} client:load />
  ) : (
    <LeftNavigation pages={componentPages} currentUrl={pathname} client:load />
  )
}
